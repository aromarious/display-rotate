#!/bin/sh
export DISPLAY_ROTATE_ID=$(cat ~/.display-rotate)
result=$(displayplacer list | tail -1 | node -e '
const input = require("fs").readFileSync(0, "utf-8");
const rotateResolution = (match, width, height) => {
  return `res:${height}x${width}`;
};
const output =
  input
  .replace(new RegExp(`(id:${process.env.DISPLAY_ROTATE_ID}.*?degree:)(\\d+)`), (_, prefix, degree) =>
    `${prefix}${(parseInt(degree, 10) + 90) % 360}`)
  .replace(/res:(\d+)x(\d+)/, (_, width, height) =>`res:${height}x${width}`);
console.log(output);
')
eval $result
